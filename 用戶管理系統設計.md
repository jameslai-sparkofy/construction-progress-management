# ç”¨æˆ¶ç®¡ç†ç³»çµ±è¨­è¨ˆ

## ç³»çµ±æ¶æ§‹èª¿æ•´

### æ ¸å¿ƒæ¦‚å¿µ
1. **ç®¡ç†å“¡**ï¼šæŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰ç”¨æˆ¶
2. **å·¥ç­ä¸»è¦è² è²¬äºº**ï¼šå›ºå®šå·¥ç­ï¼Œç®¡ç†è‡ªå·±å·¥ç­æˆå“¡
3. **ç”¨æˆ¶åˆ—è¡¨ç®¡ç†**ï¼šæ”¯æ´ç·¨è¼¯å’Œåˆªé™¤åŠŸèƒ½
4. **æ¬Šé™å›ºå®š**ï¼šå·¥ç­ä¸»è¦è² è²¬äººä¸éœ€è¦é¸æ“‡å·¥ç­

## è§’è‰²åŠŸèƒ½å®šç¾©

### 1. ç®¡ç†å“¡åŠŸèƒ½
- **ç”¨æˆ¶ç®¡ç†**ï¼š
  - æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ¶åˆ—è¡¨
  - å‰µå»ºå·¥ç­ä¸»è¦è² è²¬äºº
  - å‰µå»ºæ¥­ä¸»
  - ç·¨è¼¯ç”¨æˆ¶è³‡æ–™
  - åˆªé™¤ç”¨æˆ¶
- **ç³»çµ±ç®¡ç†**ï¼š
  - æŸ¥çœ‹æ‰€æœ‰æ¡ˆå ´é€²åº¦
  - ç³»çµ±è¨­å®š

### 2. å·¥ç­ä¸»è¦è² è²¬äººåŠŸèƒ½
- **èº«ä»½é¡¯ç¤º**ï¼šXXå·¥ç­è² è²¬äºº
- **æˆå“¡ç®¡ç†**ï¼š
  - æŸ¥çœ‹è‡ªå·±å·¥ç­æˆå“¡åˆ—è¡¨
  - å‰µå»ºå·¥ç­æˆå“¡ï¼ˆåªéœ€å§“åå’Œé›»è©±ï¼‰
  - ç·¨è¼¯å·¥ç­æˆå“¡è³‡æ–™
  - åˆªé™¤å·¥ç­æˆå“¡
- **é€²åº¦ç®¡ç†**ï¼š
  - æŸ¥çœ‹å’Œç·¨è¼¯è‡ªå·±å·¥ç­è² è²¬çš„å€åŸŸ

### 3. å·¥ç­æˆå“¡åŠŸèƒ½
- **é€²åº¦æ“ä½œ**ï¼š
  - æŸ¥çœ‹å’Œç·¨è¼¯æ‰€å±¬å·¥ç­è² è²¬çš„å€åŸŸ

### 4. æ¥­ä¸»åŠŸèƒ½
- **å…¨åŸŸæ¬Šé™**ï¼š
  - æŸ¥çœ‹å’Œç·¨è¼¯æ‰€æœ‰å€åŸŸ

## ç”¨æˆ¶ç®¡ç†ç•Œé¢è¨­è¨ˆ

### ç®¡ç†å“¡ - ç”¨æˆ¶ç®¡ç†ç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘¥ ç”¨æˆ¶ç®¡ç†                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ å‰µå»ºå·¥ç­ä¸»è¦è² è²¬äºº ]  [ å‰µå»ºæ¥­ä¸» ]                           â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“‹ æ‰€æœ‰ç”¨æˆ¶åˆ—è¡¨                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ å§“å    â”‚ é›»è©±        â”‚ è§’è‰²         â”‚ å·¥ç­    â”‚ æ“ä½œ    â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ å¼µä¸‰    â”‚ 17600000001 â”‚ å·¥ç­ä¸»è¦è² è²¬äººâ”‚ ABCå·¥ç¨‹è¡Œâ”‚ ç·¨è¼¯ åˆªé™¤â”‚ â”‚
â”‚  â”‚ æå››    â”‚ 17600000002 â”‚ å·¥ç­æˆå“¡     â”‚ ABCå·¥ç¨‹è¡Œâ”‚ ç·¨è¼¯ åˆªé™¤â”‚ â”‚
â”‚  â”‚ ç‹äº”    â”‚ 17600000003 â”‚ å·¥ç­æˆå“¡     â”‚ ABCå·¥ç¨‹è¡Œâ”‚ ç·¨è¼¯ åˆªé™¤â”‚ â”‚
â”‚  â”‚ è¶™å…­    â”‚ 17600000004 â”‚ å·¥ç­ä¸»è¦è² è²¬äººâ”‚ XYZå»ºè¨­  â”‚ ç·¨è¼¯ åˆªé™¤â”‚ â”‚
â”‚  â”‚ é™³ä¸ƒ    â”‚ 17700000001 â”‚ æ¥­ä¸»         â”‚ -       â”‚ ç·¨è¼¯ åˆªé™¤â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å·¥ç­ä¸»è¦è² è²¬äºº - æˆå“¡ç®¡ç†ç•Œé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘· ABCå·¥ç¨‹è¡Œ - æˆå“¡ç®¡ç†                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ å‰µå»ºå·¥ç­æˆå“¡ ]                                              â”‚
â”‚                                                                 â”‚
â”‚  ğŸ“‹ æˆ‘çš„å·¥ç­æˆå“¡                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ å§“å    â”‚ é›»è©±        â”‚ åŠ å…¥æ™‚é–“     â”‚ æ“ä½œ              â”‚ â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚  â”‚ æå››    â”‚ 17600000002 â”‚ 2025-01-15   â”‚ ç·¨è¼¯ åˆªé™¤         â”‚ â”‚
â”‚  â”‚ ç‹äº”    â”‚ 17600000003 â”‚ 2025-01-16   â”‚ ç·¨è¼¯ åˆªé™¤         â”‚ â”‚
â”‚  â”‚ è¶™å…«    â”‚ 17600000008 â”‚ 2025-01-17   â”‚ ç·¨è¼¯ åˆªé™¤         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## æ•¸æ“šçµæ§‹è¨­è¨ˆ

### ç”¨æˆ¶æ•¸æ“šçµæ§‹
```javascript
const users = [
    {
        id: "user001",
        name: "å¼µä¸‰",
        phone: "17600000001",
        role: "contractor_leader",
        contractor_id: "contractor_A",
        contractor_name: "ABCå·¥ç¨‹è¡Œ",
        created_at: "2025-01-15T10:00:00Z",
        created_by: "admin001",
        is_active: true
    },
    {
        id: "user002",
        name: "æå››", 
        phone: "17600000002",
        role: "contractor_member",
        contractor_id: "contractor_A",
        contractor_name: "ABCå·¥ç¨‹è¡Œ",
        created_at: "2025-01-15T11:00:00Z",
        created_by: "user001", // å·¥ç­ä¸»è¦è² è²¬äººå‰µå»º
        is_active: true
    },
    {
        id: "user003",
        name: "é™³ä¸ƒ",
        phone: "17700000001",
        role: "owner",
        contractor_id: null,
        contractor_name: null,
        created_at: "2025-01-15T12:00:00Z",
        created_by: "admin001",
        is_active: true
    }
];
```

### æ¡ˆå ´-å·¥ç­æ˜ å°„
```javascript
const siteContractorMapping = {
    "site123": {
        "contractor_A": {
            name: "ABCå·¥ç¨‹è¡Œ",
            leader_id: "user001",
            members: ["user002", "user003"],
            assigned_areas: {
                buildings: ["A"],
                floors: "all"
            }
        },
        "contractor_B": {
            name: "XYZå»ºè¨­",
            leader_id: "user004",
            members: ["user005"],
            assigned_areas: {
                buildings: ["B"],
                floors: "all"
            }
        }
    }
};
```

## åŠŸèƒ½æµç¨‹è¨­è¨ˆ

### ç®¡ç†å“¡å‰µå»ºå·¥ç­ä¸»è¦è² è²¬äºº
1. é»æ“Šã€Œå‰µå»ºå·¥ç­ä¸»è¦è² è²¬äººã€
2. å¡«å¯«ï¼šå§“åã€é›»è©±ã€é¸æ“‡å·¥ç­
3. ç³»çµ±è‡ªå‹•è¨­å®šè©²ç”¨æˆ¶ç‚ºè©²å·¥ç­çš„è² è²¬äºº
4. æ›´æ–°ç”¨æˆ¶åˆ—è¡¨

### å·¥ç­ä¸»è¦è² è²¬äººå‰µå»ºæˆå“¡
1. é»æ“Šã€Œå‰µå»ºå·¥ç­æˆå“¡ã€
2. å¡«å¯«ï¼šå§“åã€é›»è©±ï¼ˆå·¥ç­å·²å›ºå®šï¼‰
3. ç³»çµ±è‡ªå‹•å°‡æˆå“¡åŠ å…¥è©²å·¥ç­
4. æ›´æ–°æˆå“¡åˆ—è¡¨

### ç·¨è¼¯ç”¨æˆ¶åŠŸèƒ½
1. é»æ“Šã€Œç·¨è¼¯ã€æŒ‰éˆ•
2. å½ˆå‡ºç·¨è¼¯è¡¨å–®ï¼ˆé å¡«ç¾æœ‰è³‡æ–™ï¼‰
3. ä¿®æ”¹å§“åæˆ–é›»è©±
4. ä¿å­˜æ›´æ–°

### åˆªé™¤ç”¨æˆ¶åŠŸèƒ½
1. é»æ“Šã€Œåˆªé™¤ã€æŒ‰éˆ•
2. ç¢ºèªåˆªé™¤å°è©±æ¡†
3. è»Ÿåˆªé™¤ï¼ˆè¨­å®š is_active = falseï¼‰
4. æ›´æ–°åˆ—è¡¨é¡¯ç¤º

## APIè¨­è¨ˆ

### ç²å–ç”¨æˆ¶åˆ—è¡¨
```javascript
// ç®¡ç†å“¡ç²å–æ‰€æœ‰ç”¨æˆ¶
GET /api/users?role=admin
Response: {
    users: [
        {
            id: "user001",
            name: "å¼µä¸‰",
            phone: "17600000001",
            role: "contractor_leader",
            contractor_name: "ABCå·¥ç¨‹è¡Œ",
            created_at: "2025-01-15T10:00:00Z"
        }
    ]
}

// å·¥ç­ä¸»è¦è² è²¬äººç²å–è‡ªå·±çš„æˆå“¡
GET /api/users/members?contractor_id=contractor_A
Response: {
    members: [
        {
            id: "user002",
            name: "æå››",
            phone: "17600000002",
            created_at: "2025-01-15T11:00:00Z"
        }
    ]
}
```

### å‰µå»ºç”¨æˆ¶
```javascript
// ç®¡ç†å“¡å‰µå»ºå·¥ç­ä¸»è¦è² è²¬äºº
POST /api/users/create
Request: {
    name: "å¼µä¸‰",
    phone: "17600000001",
    role: "contractor_leader",
    contractor_id: "contractor_A"
}

// å·¥ç­ä¸»è¦è² è²¬äººå‰µå»ºæˆå“¡
POST /api/users/create-member
Request: {
    name: "æå››",
    phone: "17600000002",
    contractor_id: "contractor_A" // å¾ç™»å…¥ç”¨æˆ¶è‡ªå‹•å–å¾—
}
```

### ç·¨è¼¯ç”¨æˆ¶
```javascript
PUT /api/users/{user_id}
Request: {
    name: "å¼µä¸‰ï¼ˆæ›´æ–°ï¼‰",
    phone: "17600000001",
    is_active: true
}
```

### åˆªé™¤ç”¨æˆ¶
```javascript
DELETE /api/users/{user_id}
Response: {
    success: true,
    message: "ç”¨æˆ¶å·²åˆªé™¤"
}
```

## æ¬Šé™æ§åˆ¶

### ç®¡ç†å“¡æ¬Šé™
```javascript
function canManageUser(admin, targetUser) {
    return admin.role === 'admin';
}
```

### å·¥ç­ä¸»è¦è² è²¬äººæ¬Šé™
```javascript
function canManageMember(leader, member) {
    return leader.role === 'contractor_leader' && 
           leader.contractor_id === member.contractor_id;
}
```

## UIçµ„ä»¶è¨­è¨ˆ

### ç”¨æˆ¶åˆ—è¡¨çµ„ä»¶
```javascript
// ç”¨æˆ¶åˆ—è¡¨è¡¨æ ¼
function UserListTable({ users, onEdit, onDelete, userRole }) {
    return (
        <table>
            <thead>
                <tr>
                    <th>å§“å</th>
                    <th>é›»è©±</th>
                    <th>è§’è‰²</th>
                    {userRole === 'admin' && <th>å·¥ç­</th>}
                    <th>æ“ä½œ</th>
                </tr>
            </thead>
            <tbody>
                {users.map(user => (
                    <tr key={user.id}>
                        <td>{user.name}</td>
                        <td>{user.phone}</td>
                        <td>{getRoleName(user.role)}</td>
                        {userRole === 'admin' && <td>{user.contractor_name}</td>}
                        <td>
                            <button onClick={() => onEdit(user)}>ç·¨è¼¯</button>
                            <button onClick={() => onDelete(user)}>åˆªé™¤</button>
                        </td>
                    </tr>
                ))}
            </tbody>
        </table>
    );
}
```

### ç·¨è¼¯ç”¨æˆ¶Modal
```javascript
function EditUserModal({ user, onSave, onClose }) {
    const [name, setName] = useState(user.name);
    const [phone, setPhone] = useState(user.phone);
    
    const handleSave = () => {
        onSave({ ...user, name, phone });
        onClose();
    };
    
    return (
        <div className="modal">
            <div className="modal-content">
                <h3>ç·¨è¼¯ç”¨æˆ¶</h3>
                <input 
                    value={name} 
                    onChange={(e) => setName(e.target.value)}
                    placeholder="å§“å"
                />
                <input 
                    value={phone} 
                    onChange={(e) => setPhone(e.target.value)}
                    placeholder="é›»è©±"
                />
                <button onClick={handleSave}>ä¿å­˜</button>
                <button onClick={onClose}>å–æ¶ˆ</button>
            </div>
        </div>
    );
}
```

## å¯¦ç¾å„ªå…ˆç´š

### ç¬¬ä¸€éšæ®µï¼šåŸºç¤åŠŸèƒ½
1. ç”¨æˆ¶åˆ—è¡¨é¡¯ç¤º
2. å‰µå»ºç”¨æˆ¶åŠŸèƒ½
3. åŸºæœ¬çš„ç·¨è¼¯å’Œåˆªé™¤

### ç¬¬äºŒéšæ®µï¼šé€²éšåŠŸèƒ½
1. æœç´¢å’Œç¯©é¸
2. æ‰¹é‡æ“ä½œ
3. ç”¨æˆ¶æ´»å‹•æ—¥èªŒ

### ç¬¬ä¸‰éšæ®µï¼šå„ªåŒ–åŠŸèƒ½
1. å°å…¥å°å‡ºåŠŸèƒ½
2. æ¬Šé™å¯©è¨ˆ
3. ç”¨æˆ¶çµ±è¨ˆå ±è¡¨