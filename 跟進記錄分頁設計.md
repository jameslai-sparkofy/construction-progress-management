# 跟進記錄分頁設計

## 功能概述
跟進記錄分頁用於顯示與當前商機相關的銷售跟進記錄，只顯示「外部顯示」欄位設定為「顯示」的記錄。

## 數據來源
- **API對象**：ActiveRecordObj（銷售跟進記錄）
- **關聯條件**：關聯商機ID = 當前商機ID
- **篩選條件**：外部顯示 = "顯示"
- **排序**：按創建時間倒序排列

## API查詢結構（待確認正確端點）
```javascript
{
    corpId: corpId,
    corpAccessToken: token,
    currentOpenUserId: userId,
    data: {
        dataObjectApiName: "ActiveRecordObj",
        search_query_info: {
            limit: 20,
            offset: 0,
            filters: [
                {
                    field_name: "opportunity_id",
                    field_values: [opportunityId],
                    operator: "EQ"
                },
                {
                    field_name: "external_display", // 或其他外部顯示欄位名稱
                    field_values: ["顯示"],
                    operator: "EQ"
                }
            ],
            orders: [{fieldName: "create_time", isAsc: "false"}]
        }
    }
}
```

## 預期數據結構
根據跟進記錄的常見欄位，可能包含：
- `_id`: 記錄ID
- `create_time`: 創建時間
- `opportunity_id`: 關聯商機ID
- `content`: 跟進內容
- `follow_up_type`: 跟進類型
- `next_follow_up_time`: 下次跟進時間
- `external_display`: 外部顯示設定
- `created_by`: 創建人
- `customer_feedback`: 客戶反饋

## UI設計規範

### 手機版佈局
```
┌─────────────────────────┐
│   📝 跟進記錄           │
│                         │
│ ┌─────────────────────┐ │
│ │ 2025-01-15 10:30    │ │
│ │ 陳業務              │ │
│ │ 電話跟進            │ │
│ │ 客戶對施工進度很    │ │
│ │ 滿意，預計下週完工  │ │
│ │                     │ │
│ │ 下次跟進: 2025-01-20│ │
│ └─────────────────────┘ │
│                         │
│ ┌─────────────────────┐ │
│ │ 2025-01-12 14:15    │ │
│ │ 李主管              │ │
│ │ 現場確認            │ │
│ │ 確認維修項目，客戶  │ │
│ │ 要求加快進度        │ │
│ └─────────────────────┘ │
└─────────────────────────┘
```

### 電腦版佈局
```
┌─────────────────────────────────────────────────────────────────────────────────────────┐
│                                📝 跟進記錄                                               │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 時間          │ 跟進人  │ 類型     │ 跟進內容                      │ 下次跟進      │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 2025-01-15    │ 陳業務  │ 電話跟進 │ 客戶對施工進度很滿意，       │ 2025-01-20    │
│ 10:30         │         │          │ 預計下週完工                  │               │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 2025-01-12    │ 李主管  │ 現場確認 │ 確認維修項目，客戶要求       │ -             │
│ 14:15         │         │          │ 加快進度                      │               │
├─────────────────────────────────────────────────────────────────────────────────────────┤
│ 2025-01-10    │ 王工程師│ 現場勘查 │ 完成初步勘查，確認維修       │ 2025-01-15    │
│ 09:00         │         │          │ 範圍和材料需求               │               │
└─────────────────────────────────────────────────────────────────────────────────────────┘
```

## 欄位權限設計
跟進記錄的權限相對簡單，主要是查看權限：

| 欄位 | 工班 | 業主 | 管理員 |
|------|------|------|--------|
| 跟進時間 | 查看 | 查看 | 查看 |
| 跟進人 | 查看 | 查看 | 查看 |
| 跟進類型 | 查看 | 查看 | 查看 |
| 跟進內容 | 查看 | 查看 | 查看 |
| 下次跟進時間 | 查看 | 查看 | 查看 |
| 客戶反饋 | 查看 | 查看 | 查看 |

## 功能特點
1. **時間線顯示**：按時間順序顯示跟進記錄
2. **關鍵信息突出**：跟進時間、跟進人、跟進類型
3. **內容摘要**：移動端顯示內容摘要，桌面端顯示完整內容
4. **自動刷新**：定期刷新獲取最新跟進記錄
5. **篩選功能**：按跟進類型、跟進人篩選（可選）

## 實現注意事項
1. **API端點確認**：需要確認正確的跟進記錄查詢API端點
2. **外部顯示欄位**：需要確認「外部顯示」欄位的實際API名稱
3. **數據格式化**：時間格式化、內容長度控制
4. **權限控制**：確保只顯示設定為外部顯示的記錄
5. **性能優化**：分頁載入，避免一次載入過多記錄

## 開發步驟
1. 確認跟進記錄API端點和參數
2. 測試API連接和數據結構
3. 實現基礎查詢功能
4. 設計響應式UI組件
5. 實現權限控制
6. 添加自動刷新功能
7. 優化性能和用戶體驗

## 後續增強功能（可選）
- 添加新跟進記錄（限管理員）
- 跟進記錄搜索功能
- 匯出跟進記錄
- 跟進提醒功能